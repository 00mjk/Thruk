INSTALLATION
============

the proper way to install will be using local::lib:

Install local::lib
------------------

Follow the steps on http://search.cpan.org/perldoc?local::lib#The_bootstrapping_technique

quick guide:

    wget http://search.cpan.org/CPAN/authors/id/A/AP/APEIRON/local-lib-1.004009.tar.gz
    tar zxf local-lib-1.004009.tar.gz
    cd local-lib-1.004009
    perl Makefile.PL --bootstrap && make install


Install Nagios-Web-Catalyst
---------------------------

You may have to install the "Module::Install" perl module prior this installation.

    git clone git@github.com:sni/Nagios-Web-Catalyst.git
    cd Nagios-Web-Catalyst
    perl Makefile.PL
    make installdeps

run perl Makefile.PL again to see if all dependecies are now installed properly.

    perl Makefile.PL



Configuration
=============
open "thruk.conf" and adjust the livestatus settings to your needs.



Test
====

verify installation with the packaged perl test

    make test



Start Server
============
After running these steps successfully, you should be able to test your installation:

    ./script/thruk_server.pl

Open your browser and open http://<your_nagios_host>:3000 


FastCGI Server
==============

you will need three additional perl modules:
FCGI, FCGI::ProcManager and Catalyst::Engine::FastCGI

start your fcgi server:

    %>./script/thuk_fastcgi.pl -n 5 \
                -l /tmp/nagios-web.socket \
                -p /tmp/nagios-web.pid


Apache Configuration
--------------------

use this apache example configuration:

 - replace /home/user/Thruk with your installation path
 - replace your-web-host.local with your hostname
 - create a /home/user/Thruk/htpasswd.users with htpasswd2
 - make sure the /home/user/Thruk/logs/ directory exists

--------------------------------
<VirtualHost *:80>
    ServerName   your-host.local

    DocumentRoot /home/user/Thruk/root/
    CustomLog    /home/user/Thruk/logs/access.log combined
    ErrorLog     /home/user/Thruk/logs/error.log

    # authorization
    <Location "/">
        AuthName "Monitoring Access"
        AuthType Basic
        AuthUserFile /home/user/Thruk/htpasswd.users
        Order Allow,Deny
        Allow from all
        require valid-user
    </Location>

    # Load fastcgi module unless already loaded
    LoadModule fastcgi_module /usr/lib/apache2/modules/mod_fastcgi.so

    # fastcgi configuration
    FastCGIExternalServer /tmp/thruk.fcgi -socket /tmp/thruk.socket

    # Load rewrite module unless already loaded
    LoadModule rewrite_module /usr/lib/apache2/modules/mod_rewrite.so

    # rewrite configuration
    RewriteEngine On
    RewriteCond %{HTTP:Authorization} ^(.+)
    RewriteRule ^(.*)$ $1 [E=HTTP_AUTHORIZATION:%1]
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteRule ^/(.*)$ /tmp/thruk.fcgi/$1 [QSA,L]
</VirtualHost>
--------------------------------
